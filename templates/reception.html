{# templates/reception.html #}
{% extends "base.html" %}
{% block title %}접수{% endblock %}

{% block content %}
<div class="page-container d-flex flex-column align-items-center justify-content-center text-center p-3">
  {% if step == "method" %}
  <h2 class="mb-4">접수 방법을 선택하세요</h2>
  <form method="post" class="w-100" style="max-width: 640px;">
    <button class="btn btn-primary btn-lg d-block w-100 my-3" name="action" value="scan">주민등록증 인식</button>
    <button class="btn btn-primary btn-lg d-block w-100 my-3" name="action" value="manual">직접 입력</button>
  </form>

  {% elif step == "input" %}
  <h2 class="mb-3">개인정보 입력</h2>
  {% if err %}<p class="text-danger font-weight-bold">{{ err }}</p>{% endif %}
  <form method="post" class="w-100" style="max-width: 320px;">
    <input type="hidden" name="action" value="manual">
    <div class="form-group mb-3">
      <label for="name" class="d-block text-left mb-1">이름</label>
      <input type="text" id="name" name="name" class="form-control form-control-lg" required>
    </div>
    <div class="form-group mb-3">
      <label for="rrn" class="d-block text-left mb-1">주민번호</label>
      <input type="text" id="rrn" name="rrn" class="form-control form-control-lg" placeholder="YYYYMMDD-XXXXXXX" required>
    </div>
    <button class="btn btn-primary btn-lg d-block w-100 mt-4">확인</button>
  </form>

  {% elif step == "reserved" %}
  <h2 class="mb-3">예약이 확인되었습니다</h2>
  <p><strong>{{ name }}</strong> 님</p>
  <p>진료과&nbsp;:&nbsp;{{ department }}</p>
  <p>예약 시간&nbsp;:&nbsp;{{ time }}</p>
  <p>위치&nbsp;:&nbsp;{{ location }}</p>
  <p>담당 의사&nbsp;:&nbsp;{{ doctor }}</p>
  <button class="btn btn-secondary mt-4" onclick="location.href='/'">홈으로</button>

  {% elif step == "symptom" %}
  <h2 class="mb-3">확인된 예약 내역이 없습니다<br>증상을 선택해주세요</h2>
  <form method="post" class="w-100" style="max-width: 320px;">
    <input type="hidden" name="action" value="choose_symptom">
    <div class="symptom-list text-left mb-3">
      {% for code, label in symptoms %}
      <div class="form-check symptom-item my-2">
        <input class="form-check-input" type="radio" name="symptom" value="{{ code }}" id="symptom_{{ code }}" required>
        <label class="form-check-label" for="symptom_{{ code }}">
          {{ label }}
        </label>
      </div>
      {% endfor %}
    </div>
    <button class="btn btn-primary btn-lg d-block w-100 mt-3">확인</button>
  </form>

  {% elif step == "ticket" %}
  <h2 class="mb-3">번호표가 발급되었습니다</h2>
  <p>안내 진료과&nbsp;:&nbsp;{{ department }}</p>
  <p class="ticket-display my-3">{{ ticket }}</p>
  <p>안내 창호에 호출될 때까지 대기해 주세요.</p>
  <button class="btn btn-secondary mt-4" onclick="location.href='/'">홈으로</button>
  {% endif %}
</div>
{% endblock %}
